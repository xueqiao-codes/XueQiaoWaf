<UserControl x:Class="XueQiaoWaf.Trade.Modules.Presentation.Views.XqComposeOrderExecParamsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:moduleconvert="clr-namespace:XueQiaoWaf.Trade.Modules.Presentation.Converters"
             xmlns:convert="clr-namespace:XueQiaoFoundation.BusinessResources.Converters;assembly=XueQiaoFoundation.BusinessResources"
             xmlns:uiconvert="clr-namespace:XueQiaoFoundation.UI.Converters;assembly=XueQiaoFoundation.UI"
             xmlns:arbitrage="clr-namespace:xueqiao.trade.hosting.arbitrage.thriftapi;assembly=IDLAutoGenerated"
             xmlns:native_trade="clr-namespace:NativeModel.Trade;assembly=NativeModel"
             xmlns:vm="clr-namespace:XueQiaoWaf.Trade.Modules.Applications.ViewModels;assembly=XueQiaoWaf.Trade.Modules.Applications"
             mc:Ignorable="d" 
             d:DataContext="{x:Type vm:XqComposeOrderExecParamsVM}"
             d:DesignHeight="600" d:DesignWidth="800">
    <UserControl.Resources>
        <convert:XQComposeOrderExecParamsSendType2NameConverter x:Key="XQComposeOrderExecParamsSendType2NameConverter"/>
        <convert:HostingXQComposeLimitOrderFirstLegChooseMode2NameConverter x:Key="HostingXQComposeLimitOrderFirstLegChooseMode2NameConverter"/>
        <moduleconvert:XqComposeOrderLegExecParamsDM2DescConverter x:Key="XqComposeOrderLegExecParamsDM2DescConverter" DescItemSeperator="&#x0a;"/>
        <uiconvert:EqualityToVisibilityConverter x:Key="Equal2VisibleConverter" CollapsedWhenEquals="False" CollapsedWhenNotEquals="True"/>
        <uiconvert:EqualityToVisibilityConverter x:Key="Equal2CollapsedConverter" CollapsedWhenEquals="True" CollapsedWhenNotEquals="False"/>
    </UserControl.Resources>
    <DockPanel Margin="20,20,20,10">
        <StackPanel DockPanel.Dock="Top" Orientation="Vertical">
            <TextBlock>
                <Run Text="发单方式："/>
                <Run Text="{Binding OrderSendType, Mode=OneWay, Converter={StaticResource XQComposeOrderExecParamsSendType2NameConverter}, TargetNullValue={StaticResource NullValueDataDefaultDisplayText}, FallbackValue={StaticResource NullValueDataDefaultDisplayText}}"/>
            </TextBlock>
            <TextBlock Margin="0,5,0,0">
                <Run Text="提前收市暂停时间："/>
                <Run Text="{Binding EarlySuspendedForMarketSeconds, Mode=OneWay, TargetNullValue={StaticResource NullValueDataDefaultDisplayText}, FallbackValue={StaticResource NullValueDataDefaultDisplayText}}"/>
                <Run Text="秒"/>
            </TextBlock>
            <StackPanel 
                Orientation="Horizontal" Margin="0,5,0,0"
                Visibility="{Binding OrderSendType, 
                             Converter={StaticResource Equal2CollapsedConverter}, 
                             ConverterParameter={x:Static native_trade:XQComposeOrderExecParamsSendType.PARALLEL_LEG}}">
                <TextBlock>
                    <Run Text="先手选择模式："/>
                    <Run Text="{Binding FirstLegChooseDM.ChooseMode, Mode=OneWay,
                                Converter={StaticResource HostingXQComposeLimitOrderFirstLegChooseMode2NameConverter}}"/>
                </TextBlock>

                <TextBlock
                    Margin="15,0,0,0"
                    Visibility="{Binding FirstLegChooseDM.ChooseMode, 
                             Converter={StaticResource Equal2VisibleConverter},
                             ConverterParameter={x:Static arbitrage:HostingXQComposeLimitOrderFirstLegChooseMode.FIRST_LEG_CHOOSE_MODE_APPOINT}}">
                    <Run Text="指定先手腿："/>
                    <Run Text="{Binding FirstLegChooseDM.AppointContractDetailContainer.CnDisplayName, Mode=OneWay}" 
                         ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Text}"/>
                </TextBlock>
            </StackPanel>
        </StackPanel>

        <Border DockPanel.Dock="Bottom" BorderBrush="{DynamicResource BorderBrush2}" BorderThickness="1"
                Margin="0,6,0,0">
            <DataGrid Margin="15,0"
                BorderThickness="0"
                HeadersVisibility="None"
                GridLinesVisibility="None"
                CanUserReorderColumns="False"
                CanUserResizeColumns="False"
                CanUserSortColumns="False"
                ItemsSource="{Binding LegExecParamsList}">
                <DataGrid.RowStyle>
                    <Style TargetType="DataGridRow" BasedOn="{StaticResource DataGridRowWithNoSelectBG}">
                        <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush2}"/>
                        <Setter Property="BorderThickness" Value="0,1,0,0"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource PreviousData}}" Value="{x:Null}">
                                <Setter Property="BorderThickness" Value="0,0,0,0"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.RowStyle>
                <DataGrid.CellStyle>
                    <Style TargetType="DataGridCell" BasedOn="{StaticResource DataGridCellDefault}">
                        <Setter Property="Padding" Value="0,15"/>
                        <Setter Property="VerticalAlignment" Value="Top"/>
                    </Style>
                </DataGrid.CellStyle>
                <DataGrid.Columns>
                    <DataGridTemplateColumn Width="160">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Vertical" Margin="0,0,10,0">
                                    <TextBlock Text="{Binding LegDetail.BasicLeg.VariableName, StringFormat={}{0}腿：}"/>
                                    <TextBlock Text="{Binding LegDetail.LegDetailContainer.CnDisplayName}"
                                               ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Text}"
                                               TextWrapping="Wrap"
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Width="*" MinWidth="200">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock 
                                    TextWrapping="Wrap"
                                    Text="{Binding Converter={StaticResource XqComposeOrderLegExecParamsDM2DescConverter}}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Border>
    </DockPanel>
</UserControl>
