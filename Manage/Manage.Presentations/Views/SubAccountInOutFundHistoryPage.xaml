<Page 
    x:Class="Manage.Presentations.Views.SubAccountInOutFundHistoryPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:uiextra_convert="clr-namespace:XueQiaoFoundation.UI.Extra.converter;assembly=XueQiaoFoundation.UI.Extra"  
    xmlns:hosting_asset="clr-namespace:xueqiao.trade.hosting.asset.thriftapi;assembly=IDLAutoGenerated"
    mc:Ignorable="d" 
    d:DesignHeight="300"
    Background="{DynamicResource RootBgBrush}"
    Style="{StaticResource GeneralPageStyle}"
    KeepAlive="True">
    <Page.Resources>
        <uiextra_convert:Timestamp2StringConverter 
            ValueType="Millisecond"
            Convert2StringFormatType="DateTime"
            x:Key="Ms2DateTimeStringConverter"/>
    </Page.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <StackPanel Orientation="Vertical">
            <Grid Height="40">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" x:Name="NavbarFirstColumn"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="{Binding ElementName=NavbarFirstColumn, Path=ActualWidth}"/>
                </Grid.ColumnDefinitions>
                <Button Command="{Binding GoBackCmd}" Style="{StaticResource FlatContentButtonPrimary3}"
                    VerticalAlignment="Center">
                    <TextBlock>
                        <Run Text="〈 返回" FontSize="{DynamicResource RegularTitleFontSize}"/>
                    </TextBlock>
                </Button>
                <TextBlock Grid.Column="1" 
                           VerticalAlignment="Center" HorizontalAlignment="Center" 
                           Margin="10,0"
                           FontSize="{DynamicResource LargeTitleFontSize}">
                    <Run>
                        <Run.Text>
                            <MultiBinding StringFormat="操作账户{0}({1})">
                                <Binding Path="SubAccount.SubAccountId"/>
                                <Binding Path="SubAccount.SubAccountName"/>
                            </MultiBinding>
                        </Run.Text>
                    </Run>
                    <Run>的出入金历史</Run>
                </TextBlock>
            </Grid>
            <Rectangle Height="1" Fill="{DynamicResource BorderBrush3}"/>
        </StackPanel>
        <DockPanel Grid.Row="1" LastChildFill="True"
                   Margin="15,8,15,0">
            
            <ContentControl DockPanel.Dock="Bottom" Margin="0,10" 
                        HorizontalAlignment="Center"
                        Content="{Binding PagerContentView}"/>
            
            <DataGrid DockPanel.Dock="Top"
                  Margin="0,8,0,8"
                  ItemsSource="{Binding InOutFundHistoryItems}"
                  IsReadOnly="True"
                  SelectionUnit="FullRow">
                <!-- item data type: OrderRouteRuleListItemModel -->
                <DataGrid.Columns>
                    <DataGridTextColumn Header="币种" 
                                        Binding="{Binding Currency}"
                                        MinWidth="100"
                                        CanUserSort="False"/>
                    <DataGridTextColumn Header="时间" 
                                        Binding="{Binding RecordTimestampMs, Converter={StaticResource Ms2DateTimeStringConverter}}"
                                        MinWidth="100"
                                        CanUserSort="False"/>
                    <DataGridTemplateColumn Header="出入金" MinWidth="200" CanUserSort="False">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate DataType="{x:Type hosting_asset:HostingSubAccountMoneyRecord}">
                                <TextBlock>
                                    <Run x:Name="DirectionInOrOut" Text="+"/>
                                    <Run Text="{Binding TotalAmount, Mode=OneWay, StringFormat={}{0:0,0.00}}"/>
                                </TextBlock>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding Direction}" Value="{x:Static hosting_asset:HostingSubAccountMoneyRecordDirection.WITHDRAW}">
                                        <Setter TargetName="DirectionInOrOut" Property="Text" Value="-"/>
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTextColumn Header="入金总记录"
                                        Binding="{Binding DepositAmountAfter, StringFormat={}{0:0,0.00}}"
                                        MinWidth="200"
                                        CanUserSort="False"/>
                    <DataGridTextColumn Header="出金总记录"
                                        Binding="{Binding WithdrawAmountAfter, StringFormat={}{0:0,0.00}}"
                                        MinWidth="200"
                                        CanUserSort="False"/>
                    <DataGridTemplateColumn Header="票据" MinWidth="200" CanUserSort="False">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate DataType="{x:Type hosting_asset:HostingSubAccountMoneyRecord}">
                                <TextBox IsReadOnly="True" 
                                     Text="{Binding Ticket, Mode=OneWay}"
                                     AutoWordSelection="True"
                                     Background="Transparent"
                                     Padding="0, 0"
                                     BorderThickness="0"
                                     ScrollViewer.CanContentScroll="False" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </DockPanel>
    </Grid>
</Page>
